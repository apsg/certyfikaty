import{s as I}from"./index-Dk3fNDXK.js";import{l as T,s as E,a as P}from"./loadToast-mhfBI4iY.js";import{c as R,b as U}from"./index-BDnAZefz.js";import{s as F}from"./index-DcLRr1F8.js";import{s as z}from"./index-D83T4aAw.js";import{a8 as A,T as K,g as L,a9 as Y,N as y,f as q,o as C,h as a,a as d,e as t,w as c,u as $,v as f,j as p,t as v,c as G,d as H}from"./app-eWoWM0QS.js";import{_ as J}from"./AppLayout-BTAujB0I.js";import M from"./Create-DE4pr51W.js";import Q from"./Edit-CB_Kpy1H.js";import{p as W}from"./lodash-CSZeLXE4.js";import"./index-DEagBk4a.js";import"./index-DKmkAHrk.js";import"./index-CrDULePG.js";import"./index-CxStiEVZ.js";import"./index-CX_5T96p.js";import"./index-B28dTLHb.js";import"./index-CUxMXWMF.js";import"./index-DWfN4sef.js";import"./index-Dzo8tHLu.js";import"./index-D0HwopcZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-BT2mdL4O.js";const X={class:"card"},Z={class:"flex justify-end"},ee={class:"flex items-center gap-4"},te={key:0},he={__name:"Index",props:{title:String,filters:Object,users:Object,roles:Object,perPage:Number},setup(n){var w;const{_:k,debounce:x,pickBy:h}=W,i=n;T();const u=A(!1),g=K({}),r=L({params:{search:i.filters.search,field:i.filters.field,order:i.filters.order,createOpen:!1,editOpen:!1},user:null}),_=()=>{var o;u.value=!1,g.delete(route("user.destroy",(o=r.user)==null?void 0:o.id),{preserveScroll:!0,onSuccess:()=>{g.reset()},onError:()=>null,onFinish:()=>null})},b=(w=i.roles)==null?void 0:w.map(o=>({name:o.name,code:o.name})),N=o=>{y.get(route("user.index"),{page:o.page+1},{preserveState:!0})};return Y(()=>k.cloneDeep(r.params),x(()=>{let o=h(r.params);y.get(route("user.index"),o,{replace:!0,preserveState:!0,preserveScroll:!0})},150)),(o,e)=>{const m=z,O=U,S=F,D=R,l=P,V=E,B=I;return C(),q(J,null,{default:a(()=>[d("div",X,[t(M,{show:r.createOpen,onClose:e[0]||(e[0]=s=>r.createOpen=!1),roles:$(b),title:i.title},null,8,["show","roles","title"]),t(Q,{show:r.editOpen,onClose:e[1]||(e[1]=s=>r.editOpen=!1),roles:$(b),user:r.user,title:i.title},null,8,["show","roles","user","title"]),c(t(m,{label:"Create",onClick:e[2]||(e[2]=s=>r.createOpen=!0),icon:"pi pi-plus"},null,512),[[f,o.can(["create user"])]]),t(V,{lazy:"",value:n.users.data,paginator:"",rows:n.users.per_page,totalRecords:n.users.total,first:(n.users.current_page-1)*n.users.per_page,onPage:N,tableStyle:"min-width: 50rem"},{header:a(()=>[d("div",Z,[t(D,null,{default:a(()=>[t(O,null,{default:a(()=>e[6]||(e[6]=[d("i",{class:"pi pi-search"},null,-1)])),_:1}),t(S,{modelValue:r.params.search,"onUpdate:modelValue":e[3]||(e[3]=s=>r.params.search=s),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})])]),empty:a(()=>e[7]||(e[7]=[p(" No data found. ")])),loading:a(()=>e[8]||(e[8]=[p(" Loading data. Please wait. ")])),default:a(()=>[t(l,{header:"No"},{body:a(s=>[p(v(s.index+1),1)]),_:1}),t(l,{field:"name",header:"Name"}),t(l,{field:"email",header:"Email"}),t(l,{header:"Role"},{body:a(s=>[p(v(s.data.roles[0].name),1)]),_:1}),t(l,{field:"created_at",header:"Created"}),t(l,{field:"updated_at",header:"Updated"}),t(l,{exportable:!1,style:{"min-width":"12rem"}},{body:a(s=>[c(t(m,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:j=>(r.editOpen=!0,r.user=s.data)},null,8,["onClick"]),[[f,o.can(["update user"])]]),c(t(m,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:j=>{u.value=!0,r.user=s.data}},null,8,["onClick"]),[[f,o.can(["delete user"])]])]),_:1})]),_:1},8,["value","rows","totalRecords","first"]),t(B,{visible:u.value,"onUpdate:visible":e[5]||(e[5]=s=>u.value=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[t(m,{label:"No",icon:"pi pi-times",text:"",onClick:e[4]||(e[4]=s=>u.value=!1)}),t(m,{label:"Yes",icon:"pi pi-check",onClick:_})]),default:a(()=>[d("div",ee,[e[11]||(e[11]=d("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),r.user?(C(),G("span",te,[e[9]||(e[9]=p("Are you sure you want to delete ")),d("b",null,v(r.user.name),1),e[10]||(e[10]=p("?"))])):H("",!0)])]),_:1},8,["visible"])])]),_:1})}}};export{he as default};
