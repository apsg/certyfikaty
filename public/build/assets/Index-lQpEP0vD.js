import{s as I}from"./index-C-ZlPny3.js";import{l as M,s as E,a as F}from"./loadToast-CBewhibt.js";import{s as R,a as U}from"./index-C6YVmIDt.js";import{s as K}from"./index-CVOoQxjw.js";import{s as L}from"./index-CSEV8Cuy.js";import{_ as W}from"./AppLayout-QZN-p5qN.js";import Z from"./Create-CMG1W5eY.js";import{r as q,T as A,a as G,w as H,N as y,c as _,o as l,b as s,d as c,e as a,u as v,f,t as b,g as k,h as g}from"./app-BvEEy09s.js";import{p as J}from"./lodash-C6RqEHjZ.js";import{h as x}from"./moment-C5S46NFB.js";import"./index-D_kdoJ0u.js";import"./index-BnVfBrKg.js";import"./index-BY1rHRcS.js";import"./index-BU-uunUP.js";import"./index-BQzqyfXx.js";import"./index-DM5AZGYV.js";import"./index-D2r6Z6o9.js";import"./index-DK9VER9I.js";import"./index-DKQoeiyu.js";import"./index-Biey6vqE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-Euvkv3w3.js";const P={class:"card"},Q={class:"flex justify-end"},X={key:0,class:"text-green-500"},ee={key:1,class:"text-red-500"},te={class:"flex items-center gap-4"},ae={key:0},Ne={__name:"Index",props:{title:String,filters:Object,attempts:Object,roles:Object,perPage:Number},setup(n){var h;const{_:w,debounce:C,pickBy:N}=J,d=n;M();const p=q(!1),u=A({}),r=G({params:{search:d.filters.search,field:d.filters.field,order:d.filters.order,createOpen:!1,editOpen:!1},attempt:null}),$=(h=d.roles)==null?void 0:h.map(o=>({name:o.name,code:o.name})),S=o=>{y.get(route("admin.attempts.index"),{page:o.page+1},{preserveState:!0})};H(()=>w.cloneDeep(r.params),C(()=>{let o=N(r.params);y.get(route("admin.attempts.index"),o,{replace:!0,preserveState:!0,preserveScroll:!0})},150));const z=()=>{var o;p.value=!1,u.delete(route("admin.attempts.reset",(o=r.attempt)==null?void 0:o.id),{preserveScroll:!0,onSuccess:()=>{u.reset()},onError:()=>null,onFinish:()=>null})},D=o=>{u.post(route("admin.attempts.resend",o),{preserveScroll:!0,onSuccess:()=>{u.reset()},onError:()=>null,onFinish:()=>null})};return(o,t)=>{const m=L,j=U,O=K,T=R,i=F,Y=E,V=I;return l(),_(W,null,{default:s(()=>[c("div",P,[a(Z,{show:r.createOpen,onClose:t[0]||(t[0]=e=>r.createOpen=!1),roles:v($),title:d.title},null,8,["show","roles","title"]),a(m,{label:"Przyznaj certyfikat ręcznie",onClick:t[1]||(t[1]=e=>r.createOpen=!0),icon:"pi pi-plus"}),a(Y,{lazy:"",value:n.attempts.data,paginator:"",rows:n.attempts.per_page,totalRecords:n.attempts.total,first:(n.attempts.current_page-1)*n.attempts.per_page,onPage:S,tableStyle:"min-width: 50rem"},{header:s(()=>[c("div",Q,[a(T,null,{default:s(()=>[a(j,null,{default:s(()=>t[5]||(t[5]=[c("i",{class:"pi pi-search"},null,-1)])),_:1}),a(O,{modelValue:r.params.search,"onUpdate:modelValue":t[2]||(t[2]=e=>r.params.search=e),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})])]),empty:s(()=>t[6]||(t[6]=[f(" No data found. ")])),loading:s(()=>t[7]||(t[7]=[f(" Loading data. Please wait. ")])),default:s(()=>[a(i,{header:"No"},{body:s(e=>[f(b(e.index+1),1)]),_:1}),a(i,{field:"number",header:"Numer"}),a(i,{field:"name",header:"Imię"}),a(i,{field:"email",header:"Email"}),a(i,{field:"finished_at",header:"Ukończono/podejście"},{body:s(e=>[f(b(e.data.finished_at?v(x)(e.data.finished_at).format("YYYY-MM-DD"):v(x)(e.data.updated_at).format("YYYY-MM-DD")),1)]),_:1}),a(i,{field:"certificate.title_cleaned",header:"Certyfikat"}),a(i,{field:"is_passed",header:"Zdał"},{body:s(e=>[e.data.is_passed?(l(),k("span",X,"Tak")):(l(),k("span",ee,"Nie"))]),_:1}),a(i,{exportable:!1,style:{"min-width":"12rem"}},{body:s(e=>[e.data.is_passed?(l(),_(m,{key:0,icon:"pi pi-envelope",outlined:"",rounded:"",class:"mr-2",onClick:B=>D(e.data.id),label:"Wyślij maila"},null,8,["onClick"])):g("",!0),e.data.is_passed?g("",!0):(l(),_(m,{key:1,icon:"pi pi-refresh",outlined:"",rounded:"",severity:"danger",onClick:B=>{p.value=!0,r.attempt=e.data},label:"Resetuj czas"},null,8,["onClick"]))]),_:1})]),_:1},8,["value","rows","totalRecords","first"]),a(V,{visible:p.value,"onUpdate:visible":t[4]||(t[4]=e=>p.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[a(m,{label:"Nie",icon:"pi pi-times",text:"",onClick:t[3]||(t[3]=e=>p.value=!1)}),a(m,{label:"Tak",icon:"pi pi-check",onClick:z})]),default:s(()=>[c("div",te,[t[8]||(t[8]=c("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),r.attempt?(l(),k("span",ae,"Na pewno chcesz zresetować czas oczekiwania?")):g("",!0)])]),_:1},8,["visible"])])]),_:1})}}};export{Ne as default};
