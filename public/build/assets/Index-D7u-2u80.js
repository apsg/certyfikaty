import{s as V}from"./index-X5t8HP26.js";import{l as B,s as M,a as E}from"./loadToast-BftF5-BC.js";import{s as F,a as R}from"./index-wE47gPqE.js";import{s as U}from"./index-iPowOqfg.js";import{s as W}from"./index-B1csfq6Z.js";import{_ as L}from"./AppLayout-CrgE_isc.js";import Z from"./Create-CBtPZpYr.js";import{r as q,T as A,a as G,w as H,N as h,c as _,o as l,b as s,d as c,e as a,f,t as y,u as b,g as k,h as v}from"./app-Bxx3_Drl.js";import{p as J}from"./lodash-B6KTBWO2.js";import{h as x}from"./moment-C5S46NFB.js";import"./index-BaXv3pLf.js";import"./index-DgWvsH9x.js";import"./index-C8nGH76N.js";import"./index-25vdUZds.js";import"./index-BcT36ER3.js";import"./index-CBoqhzZT.js";import"./index-DlDvANFP.js";import"./index-DnNkoHu8.js";import"./index-Dl7XsyJU.js";import"./index-C7eQtdff.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DDrNy8jN.js";const K={class:"card"},P={class:"flex justify-end"},Q={key:0,class:"text-green-500"},X={key:1,class:"text-red-500"},ee={class:"flex items-center gap-4"},te={key:0},Ce={__name:"Index",props:{title:String,filters:Object,attempts:Object,certificates:Object,perPage:Number},setup(n){var g;const{_:w,debounce:C,pickBy:$}=J,d=n;B();const p=q(!1),u=A({}),r=G({params:{search:d.filters.search,field:d.filters.field,order:d.filters.order,createOpen:!1,editOpen:!1},attempt:null});(g=d.roles)==null||g.map(i=>({name:i.name,code:i.name}));const N=i=>{h.get(route("admin.attempts.index"),{page:i.page+1},{preserveState:!0})};H(()=>w.cloneDeep(r.params),C(()=>{let i=$(r.params);h.get(route("admin.attempts.index"),i,{replace:!0,preserveState:!0,preserveScroll:!0})},150));const z=()=>{var i;p.value=!1,u.delete(route("admin.attempts.reset",(i=r.attempt)==null?void 0:i.id),{preserveScroll:!0,onSuccess:()=>{u.reset()},onError:()=>null,onFinish:()=>null})},D=i=>{u.post(route("admin.attempts.resend",i),{preserveScroll:!0,onSuccess:()=>{u.reset()},onError:()=>null,onFinish:()=>null})};return(i,t)=>{const m=W,S=R,j=U,O=F,o=E,T=M,Y=V;return l(),_(L,null,{default:s(()=>[c("div",K,[a(Z,{show:r.createOpen,onClose:t[0]||(t[0]=e=>r.createOpen=!1),certificates:n.certificates,title:d.title},null,8,["show","certificates","title"]),a(m,{label:"Przyznaj certyfikat ręcznie",onClick:t[1]||(t[1]=e=>r.createOpen=!0),icon:"pi pi-plus"}),a(T,{lazy:"",value:n.attempts.data,paginator:"",rows:n.attempts.per_page,totalRecords:n.attempts.total,first:(n.attempts.current_page-1)*n.attempts.per_page,onPage:N,tableStyle:"min-width: 50rem"},{header:s(()=>[c("div",P,[a(O,null,{default:s(()=>[a(S,null,{default:s(()=>t[5]||(t[5]=[c("i",{class:"pi pi-search"},null,-1)])),_:1}),a(j,{modelValue:r.params.search,"onUpdate:modelValue":t[2]||(t[2]=e=>r.params.search=e),placeholder:"Wyszukaj"},null,8,["modelValue"])]),_:1})])]),empty:s(()=>t[6]||(t[6]=[f(" No data found. ")])),loading:s(()=>t[7]||(t[7]=[f(" Loading data. Please wait. ")])),default:s(()=>[a(o,{header:"ID"},{body:s(e=>[f(y(e.index+1),1)]),_:1}),a(o,{field:"number",header:"Numer"}),a(o,{field:"name",header:"Imię"}),a(o,{field:"email",header:"Email"}),a(o,{field:"finished_at",header:"Ukończono/podejście"},{body:s(e=>[f(y(e.data.finished_at?b(x)(e.data.finished_at).format("YYYY-MM-DD"):b(x)(e.data.updated_at).format("YYYY-MM-DD")),1)]),_:1}),a(o,{field:"certificate.title_cleaned",header:"Certyfikat"}),a(o,{field:"is_passed",header:"Zdał"},{body:s(e=>[e.data.is_passed?(l(),k("span",Q,"Tak")):(l(),k("span",X,"Nie"))]),_:1}),a(o,{exportable:!1,style:{"min-width":"12rem"}},{body:s(e=>[e.data.is_passed?(l(),_(m,{key:0,icon:"pi pi-envelope",outlined:"",rounded:"",class:"mr-2",onClick:I=>D(e.data.id),label:"Wyślij maila"},null,8,["onClick"])):v("",!0),e.data.is_passed?v("",!0):(l(),_(m,{key:1,icon:"pi pi-refresh",outlined:"",rounded:"",severity:"danger",onClick:I=>{p.value=!0,r.attempt=e.data},label:"Resetuj czas"},null,8,["onClick"]))]),_:1})]),_:1},8,["value","rows","totalRecords","first"]),a(Y,{visible:p.value,"onUpdate:visible":t[4]||(t[4]=e=>p.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[a(m,{label:"Nie",icon:"pi pi-times",text:"",onClick:t[3]||(t[3]=e=>p.value=!1)}),a(m,{label:"Tak",icon:"pi pi-check",onClick:z})]),default:s(()=>[c("div",ee,[t[8]||(t[8]=c("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),r.attempt?(l(),k("span",te,"Na pewno chcesz zresetować czas oczekiwania?")):v("",!0)])]),_:1},8,["visible"])])]),_:1})}}};export{Ce as default};
